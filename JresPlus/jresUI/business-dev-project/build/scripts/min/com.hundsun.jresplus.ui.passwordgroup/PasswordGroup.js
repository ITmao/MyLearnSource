Horn.PasswordGroup=Horn.extend(Horn.Field,{COMPONENT_CLASS:"PasswordGroup",field1:null,field2:null,name1:null,name2:null,defValue1:"",defValue2:"",init:function(b){var a=$(b).find("input");this.field1=$(a[0]);this.field2=$(a[1]);this.name1=this.field1.attr("name");this.name2=this.field2.attr("name");Horn.PasswordGroup.superclass.init.apply(this,arguments);if(this.field1){this.defValue1=(this.params.defValue!=undefined)?this.params.defValue:this.field1.val();this.defValue2=(this.params.defValue!=undefined)?this.params.defValue:this.field2.val()}},initEvents:function(){var a=this;this.field2.bind("blur",function(){var b=a.field2.val();if(b!=""){b=b.replace(/(^\s*)|(\s*$)/g,"");a.field2.val(b)}var c=a.field1.val();if(c!=""){c=c.replace(/(^\s*)|(\s*$)/g,"");a.field1.val(c)}Horn.Validate.onValid({data:[Horn.Validate,a]});if(c!=""&&b!=""){if(a.isValid()){var e=a.field1.val();if(a.field2.val()!=e){a.showError("校验不匹配！")}else{a.removeError()}}}else{var d=a.field2.attr("check");if(d&&d.indexOf(Horn.Validate.REQUIRED)>-1){a.showError("当前输入不能为空")}}});this.field1.blur(function(){var b=a.field2.val();if(b!=""){b=b.replace(/(^\s*)|(\s*$)/g,"");a.field2.val(b)}var c=a.field1.val();if(c!=""){c=c.replace(/(^\s*)|(\s*$)/g,"");a.field1.val(c)}Horn.Validate.onValid({data:[Horn.Validate,a]});var f=a.field1.val();var d=a.field2.val();if(f!=""&&d!=""){if(a.isValid()){if(f!=d&&d){a.showError("校验不匹配！")}else{a.removeError()}}}else{var e=a.field1.attr("check");if(e&&e.indexOf(Horn.Validate.REQUIRED)>-1){a.showError("当前输入不能为空")}}})},validate:function(){this.field1.blur();this.field2.blur()},addRule:function(g){var d=this.field1;var b=this.field2;var c=d.attr(Horn.Validate.CHECK);if(c){if(c.indexOf(g)>-1){return}c+=Horn.Validate.CHECKSEP+g}else{c=g}d.attr(Horn.Validate.CHECK,c);b.attr(Horn.Validate.CHECK,c);if(g&&g.indexOf(Horn.Validate.REQUIRED)>-1){var a=this.el.parent().parent(".g-unit-wrap");var e=$("label",a);var f=$("span.m-verify-symbol",e);if(!f.length){f=$("<span>",{"class":"m-verify-symbol",html:"*"});e.prepend(f)}else{f.html("*")}}this.removeError();this.field.removeClass("m-verify-success")},removeRule:function(e){var c=this.field1;var a=this.field2;var b=c.attr(Horn.Validate.CHECK);if(b&&b.indexOf(e)>-1){var d=b.split(Horn.Validate.CHECKSEP);d=$.grep(d,function(g,f){return g&&g!=e});c.attr(Horn.Validate.CHECK,d.join(";"));a.attr(Horn.Validate.CHECK,d.join(";"));this.removeError();this.setNotRequired()}},showError:function(b){var a=this.field1;var d=this.field2;a.removeClass("m-verify-success");a.addClass("m-verify-error");d.removeClass("m-verify-success");d.addClass("m-verify-error");b=$.type(b)=="boolean"?"校验错误":b;if(!this.msgDiv){this.msgDiv=$('<div class="m-verify-tip bottom" role="m-verify-tip" style="display: none;"></div>');this.el.after(this.msgDiv)}var c=this.msgDiv;c.html('<div class="verify-tip-arrow"></div><div class="verify-tip-inner">'+b+"</div>");c.css("display","block");this.err=true},removeError:function(){this.field1.removeClass("m-verify-error");this.field2.removeClass("m-verify-error");var b=this.get();var a=this.field1.attr(Horn.Validate.CHECK);if(a){if(this.isValid){if(this.field1.val()!=""||this.field2.val()!=""){this.field1.addClass("m-verify-success");this.field2.addClass("m-verify-success")}}}this.err=false;var c=this.msgDiv;if(c){c.remove()}delete this.msgDiv},setValue:function(a){this.field1.val(a);this.field2.val(a);this.field1.blur();this.field2.blur()},getValue:function(){return this.field1.val()},reset:function(a){var b=a?"":this.defValue1;this.setValue(b)},clearValue:function(){this.setValue("")},setEnable:function(a){var b=this;if(a){this.field1.removeAttr("disabled");this.field2.removeAttr("disabled");this.field1.blur();this.field2.blur()}else{this.field1.attr("disabled","disabled");this.field2.attr("disabled","disabled");b.removeError()}}});Horn.Field.regFieldType("div.hc_passwordgroup",Horn.PasswordGroup);