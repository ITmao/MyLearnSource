var expandfirst=false;Horn.ZtreePanel=Horn.extend(Horn.Base,{COMPONENT_CLASS:"ZtreePanel",el:null,url:null,params:{},treedata:null,beforeClick:function(){return true},onClick:function(){},onExpand:function(){},check:false,chkStyle:"checkbox",init:function(g){Horn.ZtreePanel.superclass.init.apply(this,arguments);Horn.apply(this,this.params);this.treeEl=this.el.find(".ztree");var k=this;if(this.el.attr("treeclick")){var l=this.el.attr("treeclick");if(l){l=window[l]}this.onClick=l}else{if(this.params.onClick){this.onClick=window[this.params.onClick]}}if(this.el.attr("beforetreeclick")){var l=this.el.attr("beforetreeclick");if(l){l=window[l]}this.beforeClick=l}else{if(this.params.beforeClick){this.beforeClick=window[this.params.beforeClick]}}if(this.el.attr("reRenderFn")){var l=this.el.attr("reRenderFn");if(l){l=window[l]}this.reRender=l}if(this.el.attr("onExpand")){var l=this.el.attr("onExpand");if(l){l=window[l]}this.onExpand=l}var d=false;if(this.params.async&&this.params.async==true){d=true}var o={data:{simpleData:{enable:true}},view:{nameIsHTML:true,showLine:false,showIcon:true,showTitle:true,selectedMulti:true,dblClickExpand:true,addDiyDom:function(r,q){var p="_a";var s=$("#"+q.tId+p);k.reRender(q,s)},fontCss:this.getFontCss},async:{enable:d,url:this.params.url?this.params.url:"",autoParam:this.params.otherParam?this.params.otherParam:[],otherParam:this.params.otherParam?this.params.otherParam:{},type:this.params.type?this.params.type:"post",dataFilter:this.params.dataFilter?window[this.params.dataFilter]:null},callback:{beforeClick:this.beforeClick,beforeCheck:this.params.beforeCheck?window[this.params.beforeCheck]:null,beforeAsync:this.params.beforeAsync?window[this.params.beforeAsync]:null,onAsyncSuccess:this.params.onAsyncSuccess?window[this.params.onAsyncSuccess]:this.onAsyncSuccess,onAsyncError:this.params.onAsyncError?window[this.params.onAsyncError]:null,beforeCollapse:this.params.beforeCollapse?window[this.params.beforeCollapse]:null,beforeDblClick:this.params.beforeDblClick?window[this.params.beforeDblClick]:null,beforeDrag:this.params.beforeDrag?window[this.params.beforeDrag]:null,beforeDragOpen:this.params.beforeDragOpen?window[this.params.beforeDragOpen]:null,beforeDrop:this.params.beforeDrop?window[this.params.beforeDrop]:null,beforeEditName:this.params.beforeEditName?window[this.params.beforeEditName]:null,beforeExpand:this.params.beforeExpand?window[this.params.beforeExpand]:null,beforeMouseDown:this.params.beforeMouseDown?window[this.params.beforeMouseDown]:null,beforeMouseUp:this.params.beforeMouseUp?window[this.params.beforeMouseUp]:null,beforeRemove:this.params.beforeRemove?window[this.params.beforeRemove]:null,beforeRename:this.params.beforeRename?window[this.params.beforeRename]:null,beforeRightClick:this.params.beforeRightClick?window[this.params.beforeRightClick]:null,onCheck:this.params.onCheck?window[this.params.onCheck]:null,onCollapse:this.params.onCollapse?window[this.params.onCollapse]:null,onDblClick:this.params.onDblClick?window[this.params.onDblClick]:null,onDrag:this.params.onDrag?window[this.params.onDrag]:null,onDragMove:this.params.onDragMove?window[this.params.onDragMove]:null,onExpand:this.params.onExpand?window[this.params.onExpand]:this.onExpand,onMouseDown:this.params.onMouseDown?window[this.params.onMouseDown]:null,onMouseUp:this.params.onMouseUp?window[this.params.onMouseUp]:null,onNodeCreated:this.params.onNodeCreated?window[this.params.onNodeCreated]:null,onRemove:this.params.onRemove?window[this.params.onRemove]:null,onRename:this.params.onRename?window[this.params.onRename]:null,onRightClick:this.params.onRightClick?window[this.params.onRightClick]:null,onClick:this.onClick}};var n=this.el.attr("checkMode");if(n&&n=="checkbox"){o.check={enable:true,chkStyle:n}}var h=this.el.attr("items");if(h){h=$.parseJSON(h)}else{h=[]}var c=this.treeEl;var f=this.treeEl.attr("id");if(!f){f=Horn.id();this.treeEl.attr("id",f)}if(d){$.fn.zTree.init(c,o)}else{$.fn.zTree.init(c,o,h)}this.treedata=h;this.treeObj=$.fn.zTree.getZTreeObj(f);if(this.el.attr("expandfirst")){expandfirst=true;this.treeObj.expandAll(true)}var b=this.el.attr("name");var e=this.el.parent().parent().find("#expand_"+b);var m=this.el.parent().parent().find("#unexpand_"+b);var a=this.el.parent().parent().find("#refresh_"+b);var j=this.el.parent().parent().find("#search_"+b);var i=this;e.bind("click",function(q){var p=i.getCheckedNodes(true);if(p!=null&&p.length>0){$.each(p,function(r,s){i.treeObj.expandNode(s.getParentNode(),true)})}else{i.expandAll(true)}});m.bind("click",function(q){var p=i.getCheckedNodes(true);if(p!=null&&p.length>0){$.each(p,function(r,s){i.treeObj.expandNode(s.getParentNode(),false)})}else{i.expandAll(false)}});a.bind("click",function(p){i.refresh()});j.bind("keyup",function(q){var p=i.getNodesByParamFuzzy("name",this.value,null);if(this.value!=""){$.each(p,function(r,s){s.highlight=true;i.treeObj.updateNode(s);i.treeObj.expandNode(s.getParentNode(),true)})}else{$.each(p,function(r,s){s.highlight=false;i.treeObj.updateNode(s)});i.expandAll(false)}this.focus()})},getFontCss:function(b,a){return(!!a.highlight)?{"font-weight":"bold"}:{color:"#333","font-weight":"normal"}},reRender:function(b,a){},onAsyncSuccess:function(b,d,c,e){if(expandfirst){var a=$.fn.zTree.getZTreeObj(d);a.expandAll(true)}},getTreeObj:function(){return this.treeObj},getNodes:function(){var a=this.treeObj.getNodes();return a},addNodes:function(a,c,b,d){this.treeObj.addNodes(a,c,b,d)},cancelEditName:function(a){this.treeObj.cancelEditName(a)},cancelSelectedNode:function(a){this.treeObj.cancelSelectedNode(a)},checkAllNodes:function(a){this.treeObj.checkAllNodes(a)},checkNode:function(c,b,d,a){this.treeObj.checkNode(c,b,d,a)},copyNode:function(c,b,a,d){this.treeObj.copyNode(c,b,a,d)},destroy:function(){this.treeObj.destroy()},editName:function(a){this.treeObj.editName(a)},expandAll:function(a){this.treeObj.expandAll(a)},expandNode:function(d,e,c,a,b){this.treeObj.expandNode(d,e,c,a,b)},getChangeCheckedNodes:function(){return this.treeObj.getChangeCheckedNodes()},getCheckedNodes:function(a){return this.treeObj.getCheckedNodes(a)},getNodesByParam:function(b,c,a){return this.treeObj.getNodeByParam(b,c,a)},getNodesByParamFuzzy:function(b,c,a){return this.treeObj.getNodesByParamFuzzy(b,c,a)},getSelectedNodes:function(){return this.treeObj.getSelectedNodes()},hideNode:function(a){this.treeObj.hideNode(a)},hideNodes:function(a){this.treeObj.hideNodes(a)},moveNode:function(c,b,a,d){return this.treeObj.moveNode(c,b,a,d)},reAsyncChildNodes:function(a,b,c){this.treeObj.reAsyncChildNodes(a,b,c)},refresh:function(){this.treeObj.refresh()},removeChildNodes:function(a){this.treeObj.removeChildNodes(a)},removeNode:function(b,a){this.treeObj.removeNode(b,a)},selectNode:function(b,a,c){this.treeObj.selectNode(b,a,c)},setChkDisabled:function(b,a,c,d){this.treeObj.setChkDisabled(b,a,c,d)},setEditable:function(a){this.treeObj.setEditable(a)},showNode:function(a){this.treeObj.showNode(a)},showNodes:function(a){this.treeObj.showNodes(a)},transformToArray:function(a){return this.treeObj.transformToArray(a)},transformTozTreeNodes:function(a){return this.treeObj.transformToArray(a)},updateNode:function(a,b){this.treeObj.updateNode(a,b)},getCheckedNodes:function(){return this.treeObj.getCheckedNodes()}});Horn.regUI("div.h_ztree",Horn.ZtreePanel);function jresplusUIZtreeOnExpand(a,c,b){$("#"+c).children("li").children("ul").removeAttr("style")};