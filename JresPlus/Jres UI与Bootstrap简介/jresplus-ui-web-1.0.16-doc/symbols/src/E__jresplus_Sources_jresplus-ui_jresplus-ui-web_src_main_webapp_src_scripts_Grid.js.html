<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">/**
<span class='line'>  2</span>  * 版本：
<span class='line'>  3</span>  * 系统名称: JRESPLUS
<span class='line'>  4</span>  * 模块名称: JRESPLUS-UI
<span class='line'>  5</span>  * 文件名称: Grid.js
<span class='line'>  6</span>  * 软件版权: 恒生电子股份有限公司
<span class='line'>  7</span>  * 功能描述：Grid组件对应的代码
<span class='line'>  8</span>  * 修改记录:
<span class='line'>  9</span>  * 修改日期       修改人员        修改说明
<span class='line'> 10</span>  * -----------------------------------------------------------------------
<span class='line'> 11</span>  * 2014-01-21     zhangsu   新增rowSelect属性，使grid支持点击行选中该行
<span class='line'> 12</span>  * 2014-01-21     zhangsu   Grid已选中的行高亮显示(样式h_table-over中颜色修改)
<span class='line'> 13</span>  * 2014-01-22     zhangsu   Grid支持单击事件
<span class='line'> 14</span>  * 2014-01-22     zhangsu   Grid支持双击事件
<span class='line'> 15</span>  * 2014-01-22     zhangsu   Grid列支持hidden属性
<span class='line'> 16</span>  * 2014-01-24     zhangsu   Grid列需要支持常规类型的格式化配置（日期、金额）
<span class='line'> 17</span>  * 2014-02-08     zhangsu   修改this.rowSelect设置后不生效的问题
<span class='line'> 18</span>  * 2014-03-11     zhangsu   当table的布局为fixed时候，需要为th设置默认宽度
<span class='line'> 19</span>  * 2014-03-12     zhangsu   STORY #7776 grid的titleButtons中的按纽需求有禁用、启用功能
<span class='line'> 20</span>  * 2014-04-11     周智星    BUG #6609 【grid】selectModel设置为single 造成页面报js错误并且单选变复选
<span class='line'> 21</span>  * 2014-04-11     周智星    BUG #6610 【grid】"selectModel":"multi"之后会造成复选框变成input输入框，并且应该设置的muti是拼写错误
<span class='line'> 22</span>  * 2014-04-11     周智星    BUG #6612 【grid】rowSelect属性设置true还是表现为false，必须要设置为"true"才行，和文档中描述不一致 （把文档修改为String类型）
<span class='line'> 23</span>  * 2014-04-11     周智星    BUG #6605 【grid】numbercolumn，rowselect，selectmodel的默认值与文档中不符合 （修改文档的默认值）
<span class='line'> 24</span>  * 2014-04-11     周智星    BUG #6613 【grid】多选模式下，先调用selectAll，然后调用unSelectAll之后，需要点击两下才能完成对行的选中
<span class='line'> 25</span>  * 2014-04-11     zhangsu   BUG #6599 【grid】多选模式下，只能通过点击行来选中无法通过前面的checkbox来选中
<span class='line'> 26</span>  * 2014-04-16     zhangsu   修改titlebuttons注释，添加save/query/confirm/refresh/open样式
<span class='line'> 27</span>  * 2014-04-18     zhangsu   BUG #6760 query_table手动全选后调用方法取消全选，列头上的勾还在
<span class='line'> 28</span>  * 2014-04-22     zhangsu   BUG #6797 QueryTable_加载静态数据后静态数据字典的key和value是反的
<span class='line'> 29</span>  * 2014-04-22     zhangsu   列中包含“buttons”操作列属性，“renderer”渲染属性时，该列无tip提示，其他未配置上述属性的列正常显示tip,按单元格中内容显示。
<span class='line'> 30</span>  * 2014-04-28     hanyin   BUG #6894 grid:titleButtons中按钮的属性event不设置时会报js错误
<span class='line'> 31</span>  * 2014-05-05     周智星    BUG #6943 grid：复选，去掉某行的勾，但是列头的全选勾不会去除
<span class='line'> 32</span>  * 2014-09-10     zhangsu   STORY #9591 [财富管理事业部/陈凯][TS:201409030134]-JRESPlus-ui-Grid列配置的日期格式，在谷歌下面是生效在IE下面不生效
<span class='line'> 33</span>  * 2014-09-26     zhangsu   STORY #9848 [财富管理事业部-陈为][TS:201409260006]-JRESPlus-ui-下记问题请紧急修复下，若处理完成，请临时包提供。2.】
<span class='line'> 34</span>  * 2014-09-26     zhangsu   STORY #9847 [财富管理事业部/陈为][TS:201409260005]-JRESPlus-ui-下记问题请紧急修复下，若处理完成，请临时包提供。发现】
<span class='line'> 35</span>  * 2014-10-11		wangyubao	因为要绑定menu，那么不配置onclick的按钮也应该可以正常的显示出来
<span class='line'> 36</span>  * 2014-11-10		wangyubao	STORY #10261 [财富管理事业部/陈为][TS:201411060329]-JRESPlus-ui-Grid组件的复选框列选择的时候会影响所在行的其他列中的复选】
<span class='line'> 37</span>  * 2015-02-05     zhangsu   BUG #9192 Grid全选，去掉最后一个钩，再选上，全选框没有显示选中状态
<span class='line'> 38</span>  * ----------------------------------------------------------------------- 
<span class='line'> 39</span>  */</span><span class="WHIT">
<span class='line'> 40</span> 
<span class='line'> 41</span> </span><span class="COMM">/**
<span class='line'> 42</span>  * @lends Horn.Grid#
<span class='line'> 43</span>  */</span><span class="WHIT">
<span class='line'> 44</span> 
<span class='line'> 45</span> </span><span class="COMM">/**
<span class='line'> 46</span>  * @description Grid的封装
<span class='line'> 47</span>  * @name Horn.Grid
<span class='line'> 48</span>  * @class
<span class='line'> 49</span>  * 数据列表组件，数据的装载在后台完成
<span class='line'> 50</span>  * @extends Horn.Base
<span class='line'> 51</span>  * @example
<span class='line'> 52</span>  *	&lt;pre>\	#grid({"name":"flowTable","title":"有数据的grid"
<span class='line'> 53</span>     	    ,"numbercolumn":"true","selectModel":"muti"
<span class='line'> 54</span>     		,"items":[{"name":"initDate","text":"发生日期","renderer":"domrender"},
<span class='line'> 55</span>     			{"name":"branchNo", "text":"分支名称（静态字典）","items":[{"label":"杭州总部","value":"8888"},{"label":"b","value":"b1"},{"label":"c","value":"c1"}]},
<span class='line'> 56</span>     			{"name":"branchNo", "dictName":"Branch", "text":"分支名称（动态字典）"},
<span class='line'> 57</span>     			{"name":"scanType", "dictName":"ScanType", "text":"扫描类别"},
<span class='line'> 58</span>     			{"name":"clientId","text":"客户编号"},
<span class='line'> 59</span>     			{"name":"clientName","text":"客户名称"},
<span class='line'> 60</span>     			{"name":"branchNo", "text":"操作","showwhenover":"true","buttons":[{"label":"设置默认","event":"edit"},{"label":"设置默认","event":"edit"}]},
<span class='line'> 61</span>     			{"name":"taskStatus","text":"任务状态"}
<span class='line'> 62</span>     			]
<span class='line'> 63</span>     		,"data":$data
<span class='line'> 64</span>     	})
<span class='line'> 65</span>  *	&lt;/pre>
<span class='line'> 66</span>  */</span><span class="WHIT">
<span class='line'> 67</span> 
<span class='line'> 68</span> </span><span class="COMM">/**
<span class='line'> 69</span>  * @description Grid的唯一标识。
<span class='line'> 70</span>  * @property id
<span class='line'> 71</span>  * @name Horn.Grid#&lt;b>id&lt;/b>
<span class='line'> 72</span>  * @type String
<span class='line'> 73</span>  * @default ""
<span class='line'> 74</span>  * @example
<span class='line'> 75</span>  * 无
<span class='line'> 76</span>  */</span><span class="WHIT">
<span class='line'> 77</span> 
<span class='line'> 78</span> </span><span class="COMM">/**
<span class='line'> 79</span>  * @description Grid的名称。
<span class='line'> 80</span>  * @property name
<span class='line'> 81</span>  * @name Horn.Grid#&lt;b>name&lt;/b>
<span class='line'> 82</span>  * @type String
<span class='line'> 83</span>  * @default ""
<span class='line'> 84</span>  * @example
<span class='line'> 85</span>  * 无
<span class='line'> 86</span>  */</span><span class="WHIT">
<span class='line'> 87</span> 
<span class='line'> 88</span> </span><span class="COMM">/**
<span class='line'> 89</span>  * @description Grid的数据。
<span class='line'> 90</span>  * @property data
<span class='line'> 91</span>  * @name Horn.Grid#&lt;b>data&lt;/b>
<span class='line'> 92</span>  * @type Json
<span class='line'> 93</span>  * @default null
<span class='line'> 94</span>  * @example
<span class='line'> 95</span>  * 示例：
<span class='line'> 96</span>  * [{"branchNo":8888,"initDate":"20130101"},
<span class='line'> 97</span>  *   {"branchNo":8888,"initDate":"20130101"},
<span class='line'> 98</span>  *   {"branchNo":8888,"initDate":"20130101"},
<span class='line'> 99</span>  *   {"branchNo":8888,"initDate":"20130101"},
<span class='line'>100</span>  *   {"branchNo":8888,"initDate":"20130101"},
<span class='line'>101</span>  *   {"branchNo":8888,"initDate":"20130101"},
<span class='line'>102</span>  *   {"branchNo":8888,"initDate":"20130101"}]
<span class='line'>103</span>  */</span><span class="WHIT">
<span class='line'>104</span> 
<span class='line'>105</span> </span><span class="COMM">/**
<span class='line'>106</span>  * @description Grid列表条目。
<span class='line'>107</span>  * @property items
<span class='line'>108</span>  * @name Horn.Grid#&lt;b>items&lt;/b>
<span class='line'>109</span>  * @type Array
<span class='line'>110</span>  * @default null
<span class='line'>111</span>  * @example
<span class='line'>112</span>  * items中的单个列表条目属性：
<span class='line'>113</span>  *                name        {String}   列数据索引名 即dataIndex
<span class='line'>114</span>  *                text        {String}   列头名称
<span class='line'>115</span>  *                align       {String}   列内容文本位置设置，默认分为三种方位：居左：left ，居中：center ，居右：right
<span class='line'>116</span>  *                headerAlign {String}   列头文本位置设置，默认分为三种方位：居左：left ，居中：center ，居右：right
<span class='line'>117</span>  *                hidden      {Boolean}  列是否隐藏
<span class='line'>118</span>  *                width       {String}   列宽度
<span class='line'>119</span>  *                dataType    {String}   列格式化的类型，目前只支持日期和金额两种类型，日期：dataType="DATE",金额dataType="AMOUNT"
<span class='line'>120</span>  *                format      {String}   列格式化时的格式 ，需要传入日期才能被格式化,不包含时间格式化
<span class='line'>121</span>  *                renderer    {String}   列渲染函数
<span class='line'>122</span>  *                buttons     {Array}    操作列，设置此属性后，属性值会被渲染成多个链接
<span class='line'>123</span>  *                dictName    {String}   字典条目名称
<span class='line'>124</span>  *
<span class='line'>125</span>  * 示例：
<span class='line'>126</span>  * "items" : [{"name":"initDate","text":"发生日期","align":"left","headerAlign":"right","dataType":"DATE","format":"yyyy-MM-dd","width":"150"},
<span class='line'>127</span>  *			        {"name":"branchNo", "text":"分支名称（静态字典）","items":[{"label":"杭州总部","value":"8888"},{"label":"b","value":"b1"},{"label":"c","value":"c1"}]},
<span class='line'>128</span>  *			        {"name":"branchNo", "dictName":"Branch", "text":"分支名称（动态字典）"},
<span class='line'>129</span>  *			        {"name":"scanType", "dictName":"ScanType", "text":"扫描类别","hidden":true},
<span class='line'>130</span>  *			        {"name":"scanType2","text":"扫描类别","renderer":"domrender","hidden":false,"width":"350"},
<span class='line'>131</span>  *			        {"name":"clientId","text":"客户编号","dataType":"AMOUNT","format":"0,000.0"},
<span class='line'>132</span>  *			        {"name":"clientName","text":"客户名称"},
<span class='line'>133</span>  *			        {"name":"branchNo", "text":"操作1","buttons":[{"label":"设置默认","event":"edit"}]},
<span class='line'>134</span>  *			        {"name":"branchNo", "text":"操作2","buttons":[{"label":"noting","event":"edit"}]}
<span class='line'>135</span>  *			]
<span class='line'>136</span>  */</span><span class="WHIT">
<span class='line'>137</span> 
<span class='line'>138</span> </span><span class="COMM">/**
<span class='line'>139</span>  * @description Grid标题栏上的按钮组,当按钮的"event"属性不设置或者设置的方法在当前上下文中不存在时，按钮将被隐藏
<span class='line'>140</span>  * 默认提供添加、修改、删除、确认、查询、打开、保存、刷新的样式,cls属性分别对应："add","edit","del","confirm","query","open","save","refresh"
<span class='line'>141</span>  * @property titleButtons
<span class='line'>142</span>  * @name Horn.Grid#&lt;b>titleButtons&lt;/b>
<span class='line'>143</span>  * @type Array
<span class='line'>144</span>  * @default null
<span class='line'>145</span>  * @example
<span class='line'>146</span>  * 单个按钮属性：
<span class='line'>147</span>  *	       label   {String}  按钮文本
<span class='line'>148</span>  *	       cls     {String}  按钮css样式
<span class='line'>149</span>  *	       event   {String}  按钮点击事件
<span class='line'>150</span>  *	       disabled {Boolean} 是否禁用/启用按钮
<span class='line'>151</span>  *		   refmenu {string} 按钮中关联menu组件
<span class='line'>152</span>  * 示例：
<span class='line'>153</span>  * "titleButtons" : [{"label":"添加","cls":"add","event":"add()"}]
<span class='line'>154</span>  */</span><span class="WHIT">
<span class='line'>155</span> 
<span class='line'>156</span> </span><span class="COMM">/**
<span class='line'>157</span>  * @description Grid上的事件属性
<span class='line'>158</span>  * 控件支持的事件列表如下：&lt;br>
<span class='line'>159</span>  * rowclick  行单击事件    事件参数：rowdata  当前被点击的一行数据&lt;br>
<span class='line'>160</span>  * rowdblclick  行双击事件 事件参数：rowdata  当前被点击的一行数据&lt;br>
<span class='line'>161</span>  * 注意：双击事件会触发单击事件，所以在使用双击事件时应注意与单击事件的关系&lt;br>
<span class='line'>162</span>  * @property events
<span class='line'>163</span>  * @name Horn.Grid#&lt;b>events&lt;/b>
<span class='line'>164</span>  * @type Json
<span class='line'>165</span>  * @default null
<span class='line'>166</span>  * @example
<span class='line'>167</span>  * 		   "events" :[
<span class='line'>168</span>  *	         {"event" : "rowclick" , "function" : "testgridrowclick"},
<span class='line'>169</span>  *	         {"event" : "rowdblclick", "function" : "testgridrowdbclick"}
<span class='line'>170</span>  *		   ]
<span class='line'>171</span>  */</span><span class="WHIT">
<span class='line'>172</span> 
<span class='line'>173</span> </span><span class="COMM">/**
<span class='line'>174</span>  * @description Grid是否配置序号列，默认值为false，启用序号列,设置为true时才显示序列号
<span class='line'>175</span>  * @property numbercolumn
<span class='line'>176</span>  * @name Horn.Grid#&lt;b>numbercolumn&lt;/b>
<span class='line'>177</span>  * @type Boolean
<span class='line'>178</span>  * @default false
<span class='line'>179</span>  * @example
<span class='line'>180</span>  * 无
<span class='line'>181</span>  */</span><span class="WHIT">
<span class='line'>182</span> 
<span class='line'>183</span> </span><span class="COMM">/**
<span class='line'>184</span>  * @description Grid启用单选/多选选择框 ，默认值为single,(注意，多选框 muti的拼音错了，做了兼容处理，输入multi也可以) ,单选框值为:single
<span class='line'>185</span>  * 当不配置selectModel或selectModel为""属性时,不显示选择列
<span class='line'>186</span>  * @property selectModel
<span class='line'>187</span>  * @name Horn.Grid#&lt;b>selectModel&lt;/b>
<span class='line'>188</span>  * @type String
<span class='line'>189</span>  * @default 
<span class='line'>190</span>  * @example
<span class='line'>191</span>  * 无
<span class='line'>192</span>  */</span><span class="WHIT">
<span class='line'>193</span> 
<span class='line'>194</span> </span><span class="COMM">/**
<span class='line'>195</span>  * @description Grid是否启用点击行选中行操作,默认值为false，不启用,设置为true时点击行选中才生效
<span class='line'>196</span>  * @property rowSelect
<span class='line'>197</span>  * @name Horn.Grid#&lt;b>rowSelect&lt;/b>
<span class='line'>198</span>  * @type Boolean
<span class='line'>199</span>  * @default false
<span class='line'>200</span>  * @example
<span class='line'>201</span>  * 无
<span class='line'>202</span>  */</span><span class="WHIT">
<span class='line'>203</span> 
<span class='line'>204</span> </span><span class="COMM">/**
<span class='line'>205</span>  * @description Grid列内容超出列宽时是否隐藏并加"...",默认值为false，不隐藏根据内容自适应,设置为true时才隐藏
<span class='line'>206</span>  * @property textOverHidden
<span class='line'>207</span>  * @name Horn.Grid#&lt;b>textOverHidden&lt;/b>
<span class='line'>208</span>  * @type Boolean
<span class='line'>209</span>  * @default false
<span class='line'>210</span>  * @example
<span class='line'>211</span>  * 无
<span class='line'>212</span>  */</span><span class="WHIT">
<span class='line'>213</span> 
<span class='line'>214</span> </span><span class="COMM">/**
<span class='line'>215</span>  * @description 单击行时触发&lt;br/>
<span class='line'>216</span>  * 注意：双击事件会触发单击事件，所以在使用双击事件时应注意与单击事件的关系
<span class='line'>217</span>  * @event
<span class='line'>218</span>  * @name Horn.Grid#&lt;b>rowclick&lt;/b>
<span class='line'>219</span>  * @param data  类型：[Object] 被点击的一行数据。
<span class='line'>220</span>  * @example
<span class='line'>221</span>  *
<span class='line'>222</span>  */</span><span class="WHIT">
<span class='line'>223</span> 
<span class='line'>224</span> </span><span class="COMM">/**
<span class='line'>225</span>  * @description 双击行时触发&lt;br/>
<span class='line'>226</span>  * 注意：双击事件会触发单击事件，所以在使用双击事件时应注意与单击事件的关系
<span class='line'>227</span>  * @event
<span class='line'>228</span>  * @name Horn.Grid#&lt;b>rowdblclick&lt;/b>
<span class='line'>229</span>  * @param data  类型：[Object] 被点击的一行数据。
<span class='line'>230</span>  * @example
<span class='line'>231</span>  *
<span class='line'>232</span>  */</span><span class="WHIT">
<span class='line'>233</span> </span><span class="NAME">Horn.Grid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Horn.extend</span><span class="PUNC">(</span><span class="NAME">Horn.Base</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>234</span> </span><span class="WHIT">	</span><span class="NAME">COMPONENT_CLASS</span><span class="PUNC">:</span><span class="STRN">"Grid"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>235</span> </span><span class="WHIT">	</span><span class="NAME">titleEl</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>236</span> </span><span class="WHIT">	</span><span class="NAME">data</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>237</span> </span><span class="WHIT">	</span><span class="NAME">curData</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>238</span> </span><span class="WHIT">	</span><span class="NAME">curTr</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>239</span> </span><span class="WHIT">	</span><span class="NAME">rowSelect</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>240</span> </span><span class="WHIT">	</span><span class="NAME">keyAttr</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"label"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>241</span> </span><span class="WHIT">    </span><span class="NAME">valueAttr</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"value"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>242</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>243</span> 	 * @ignore
<span class='line'>244</span> 	 */</span><span class="WHIT">
<span class='line'>245</span> </span><span class="WHIT">    </span><span class="NAME">init</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>246</span> </span><span class="WHIT">        </span><span class="NAME">Horn.Grid.superclass.init.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>247</span> </span><span class="WHIT">        </span><span class="NAME">this.ths</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">"th"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>248</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>249</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.params</span><span class="PUNC">[</span><span class="STRN">"data"</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>250</span> </span><span class="WHIT">        </span><span class="NAME">this.data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">data</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>251</span> </span><span class="WHIT">        </span><span class="WHIT">
<span class='line'>252</span> </span><span class="WHIT">        </span><span class="COMM">//this.mutiSelect = this.params['selectModel']=='muti';</span><span class="WHIT">
<span class='line'>253</span> </span><span class="WHIT">        </span><span class="COMM">//BUG #6610 【grid】"selectModel":"multi"之后会造成复选框变成input输入框，并且应该设置的muti是拼写错误</span><span class="WHIT">
<span class='line'>254</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.params</span><span class="PUNC">[</span><span class="STRN">'selectModel'</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="STRN">'muti'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.params</span><span class="PUNC">[</span><span class="STRN">'selectModel'</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="STRN">'multi'</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>255</span> </span><span class="WHIT">        	</span><span class="NAME">this.mutiSelect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>256</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>257</span> </span><span class="WHIT">        </span><span class="NAME">this.curTr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'tr.hc_formtable-cur'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>258</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">datas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.children</span><span class="PUNC">(</span><span class="STRN">'table'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">children</span><span class="PUNC">(</span><span class="STRN">'tbody'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">children</span><span class="PUNC">(</span><span class="STRN">'tr'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>259</span> </span><span class="WHIT">        </span><span class="WHIT">
<span class='line'>260</span> </span><span class="WHIT">        </span><span class="NAME">this.curData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.data</span><span class="PUNC">[</span><span class="NAME">datas.index</span><span class="PUNC">(</span><span class="NAME">this.curTr</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>261</span> </span><span class="WHIT">        </span><span class="COMM">//Grid点击行选中该行的配置支持</span><span class="WHIT">
<span class='line'>262</span> </span><span class="WHIT">        </span><span class="NAME">this.rowSelect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Boolean</span><span class="PUNC">(</span><span class="NAME">this.params</span><span class="PUNC">[</span><span class="STRN">"rowSelect"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>263</span> </span><span class="WHIT">        </span><span class="COMM">//Grid是否配置列内容超出列宽时是否隐藏并加"..."</span><span class="WHIT">
<span class='line'>264</span> </span><span class="WHIT">        </span><span class="NAME">this.textOverHidden</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.params</span><span class="PUNC">[</span><span class="STRN">"textOverHidden"</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">this.params</span><span class="PUNC">[</span><span class="STRN">"textOverHidden"</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>265</span> </span><span class="WHIT">       	</span><span class="COMM">//关于字典项目的翻译功能。</span><span class="WHIT">
<span class='line'>266</span> </span><span class="WHIT">		</span><span class="NAME">this.ths.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">,</span><span class="NAME">th</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>267</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT">	</span><span class="NAME">hidden</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attributes</span><span class="PUNC">[</span><span class="STRN">"hidden"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>268</span> </span><span class="WHIT">			</span><span class="NAME">th</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">th</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>269</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dictName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">"dictName"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>270</span> </span><span class="WHIT">				</span><span class="NAME">itemscolNo</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">'colno'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>271</span> </span><span class="WHIT">				</span><span class="NAME">staticDict</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>272</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="COMM">//设置th列宽度</span><span class="WHIT">
<span class='line'>273</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tempStaticDict</span><span class="PUNC">,</span><span class="NAME">buttons</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>274</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">itemscolNo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>275</span> </span><span class="WHIT">				</span><span class="NAME">tempStaticDict</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_this.params.items</span><span class="PUNC">[</span><span class="NAME">itemscolNo</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">items</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>276</span> </span><span class="WHIT">				</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_this.params.items</span><span class="PUNC">[</span><span class="NAME">itemscolNo</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">buttons</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>277</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>278</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>279</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">hidden</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">hidden</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">hidden.value</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"true"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>280</span> </span><span class="WHIT">				</span><span class="NAME">th.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>281</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>282</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">dictName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>283</span> </span><span class="WHIT">				</span><span class="NAME">staticDict</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>284</span> </span><span class="WHIT">				</span><span class="COMM">//先把dict解析出来，避免重复查找dom</span><span class="WHIT">
<span class='line'>285</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lis</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'.hc_checkboxdiv[ref_target='</span><span class="PUNC">+</span><span class="NAME">dictName</span><span class="PUNC">+</span><span class="STRN">'_s]'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">find</span><span class="PUNC">(</span><span class="STRN">"li"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>286</span> </span><span class="WHIT">				</span><span class="NAME">lis.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="NAME">li</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>287</span> </span><span class="WHIT">					</span><span class="NAME">li</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">li</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>288</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">label</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">li.attr</span><span class="PUNC">(</span><span class="STRN">'title'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//title显示值</span><span class="WHIT">
<span class='line'>289</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">li.attr</span><span class="PUNC">(</span><span class="STRN">'key'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">      </span><span class="COMM">//key </span><span class="WHIT">
<span class='line'>290</span> </span><span class="WHIT">					</span><span class="NAME">staticDict</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">label</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>291</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>292</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tempStaticDict</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>293</span> </span><span class="WHIT">				</span><span class="NAME">staticDict</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>294</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">tempStaticDict</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>295</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>296</span> </span><span class="WHIT">					</span><span class="NAME">staticDict</span><span class="PUNC">[</span><span class="NAME">item</span><span class="PUNC">[</span><span class="NAME">_this.keyAttr</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">[</span><span class="NAME">_this.valueAttr</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//bug 6797</span><span class="WHIT">
<span class='line'>297</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>298</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">width</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>299</span> </span><span class="WHIT">				</span><span class="NAME">th.width</span><span class="PUNC">(</span><span class="NAME">width</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>300</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>301</span> </span><span class="WHIT">			</span><span class="NAME">th.data</span><span class="PUNC">(</span><span class="STRN">'staticDict'</span><span class="PUNC">,</span><span class="NAME">staticDict</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>302</span> </span><span class="WHIT">			</span><span class="NAME">th.data</span><span class="PUNC">(</span><span class="STRN">'buttons'</span><span class="PUNC">,</span><span class="NAME">buttons</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>303</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>304</span> </span><span class="WHIT">		</span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'.h_querytable_select_all'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">change</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>305</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.checked</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>306</span> </span><span class="WHIT">				</span><span class="NAME">_this.selectAll</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>307</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>308</span> </span><span class="WHIT">				</span><span class="NAME">_this.unSelectAll</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>309</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>310</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>311</span> </span><span class="WHIT">		</span><span class="NAME">this.titleEl</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'div.h_formgridtitle'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>312</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">titleButtons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.params</span><span class="PUNC">[</span><span class="STRN">"titleButtons"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>313</span> </span><span class="WHIT">		</span><span class="NAME">this.titleEl.find</span><span class="PUNC">(</span><span class="STRN">'a'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>314</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">button</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>315</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ev</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">button.attr</span><span class="PUNC">(</span><span class="STRN">'onclick'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>316</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_disabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">titleButtons</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="STRN">"disabled"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//STORY #7776</span><span class="WHIT">
<span class='line'>317</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>318</span> </span><span class="WHIT">			</span><span class="COMM">//因为要绑定menu，那么不配置onclick的按钮也应该可以正常的显示出来</span><span class="WHIT">
<span class='line'>319</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ev</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">Horn.Util.getFunObj</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">fn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">button.attr</span><span class="PUNC">(</span><span class="STRN">"refmenu"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>320</span> </span><span class="WHIT">				</span><span class="NAME">button.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>321</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>322</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">_disabled</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>323</span> </span><span class="WHIT">				</span><span class="NAME">button.addClass</span><span class="PUNC">(</span><span class="STRN">"h_btn-disabled"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>324</span> </span><span class="WHIT">				</span><span class="NAME">button.removeAttr</span><span class="PUNC">(</span><span class="STRN">"onclick"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>325</span> </span><span class="WHIT">				</span><span class="NAME">button.click</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>326</span> </span><span class="WHIT">                    </span><span class="NAME">event.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="COMM">// 阻止弹出</span><span class="WHIT">
<span class='line'>327</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>328</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>329</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>330</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>331</span> </span><span class="WHIT">		</span><span class="NAME">this.selecteds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="WHIT">
<span class='line'>332</span> </span><span class="WHIT">		</span><span class="NAME">this.dictTrans</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>333</span> </span><span class="WHIT">		</span><span class="NAME">this.initEvents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">     </span><span class="COMM">//初始化事件</span><span class="WHIT">
<span class='line'>334</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.textOverHidden</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>335</span> </span><span class="WHIT">			</span><span class="NAME">this.resetTHWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>336</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>337</span> </span><span class="WHIT">		</span><span class="NAME">this.hiddenColumns</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//初始化隐藏列</span><span class="WHIT">
<span class='line'>338</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>339</span> </span><span class="WHIT">		   </span><span class="WHIT">
<span class='line'>340</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>341</span> </span><span class="WHIT">    </span><span class="NAME">customEvents</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"rowclick,rowdblclick"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>342</span> </span><span class="WHIT">    </span><span class="NAME">getEventTarget</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>343</span> </span><span class="WHIT">    	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.el</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>344</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>345</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>346</span>      * 初始化事件
<span class='line'>347</span>      * @ignore
<span class='line'>348</span>      */</span><span class="WHIT">
<span class='line'>349</span> </span><span class="WHIT">    </span><span class="NAME">initEvents</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>350</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_table</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.children</span><span class="PUNC">(</span><span class="STRN">'table'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>351</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_tbody</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_table.children</span><span class="PUNC">(</span><span class="STRN">'tbody'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>352</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>353</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isCheckboxAll</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_this.el.find</span><span class="PUNC">(</span><span class="STRN">'.h_querytable_select_all'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="KEYW">true</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>354</span> </span><span class="WHIT">    	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isCheckboxAll</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>355</span> </span><span class="WHIT">			</span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'input:checkbox.h_querytable_select'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">change</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>356</span> </span><span class="WHIT">				</span><span class="NAME">_this.stateTest</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>357</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>358</span> </span><span class="WHIT">	    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>359</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.rowSelect</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>360</span> </span><span class="WHIT">        	</span><span class="NAME">_tbody.children</span><span class="PUNC">(</span><span class="STRN">'tr'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>361</span> </span><span class="WHIT">    		    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rowidx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>362</span> </span><span class="WHIT">    		    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>363</span> </span><span class="WHIT">    		    </span><span class="NAME">checkbox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_this.mutiSelect</span><span class="PUNC">?</span><span class="NAME">_tr.find</span><span class="PUNC">(</span><span class="STRN">"input:checkbox.h_querytable_select"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">_tr.find</span><span class="PUNC">(</span><span class="STRN">"input:radio.h_querytable_select"</span><span class="PUNC">)</span><span class="COMM">//BUG #6574</span><span class="WHIT">
<span class='line'>364</span> </span><span class="WHIT">    		</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>365</span> </span><span class="WHIT">    		    </span><span class="WHIT">
<span class='line'>366</span> </span><span class="WHIT">    		</span><span class="COMM">//STORY #10837 【TS:201501280088-JRESPlus-财富管理事业部-陈凯-对一个grid先全选，然后去掉最后一个勾，然后再想选最后一个】</span><span class="WHIT">
<span class='line'>367</span> </span><span class="WHIT">    		</span><span class="NAME">_tr.bind</span><span class="PUNC">(</span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">    </span><span class="COMM">//BUG #6599</span><span class="WHIT">
<span class='line'>368</span> </span><span class="WHIT">    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$.isEmptyObject</span><span class="PUNC">(</span><span class="NAME">_this.selecteds</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>369</span> </span><span class="WHIT">    				</span><span class="NAME">_this.selectRow</span><span class="PUNC">(</span><span class="NAME">rowidx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>370</span> </span><span class="WHIT">    			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>371</span> </span><span class="COMM">//    				if(_this.lastSelect&&_this.lastSelect.rowidx != rowidx){</span><span class="WHIT">
<span class='line'>372</span> </span><span class="WHIT">    					 </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_this.selecteds.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">rowidx</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>373</span> </span><span class="WHIT">        				    </span><span class="NAME">_this.selectRow</span><span class="PUNC">(</span><span class="NAME">rowidx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>374</span> </span><span class="WHIT">    					 </span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>375</span> </span><span class="WHIT">    						 </span><span class="NAME">_this.unSelectRow</span><span class="PUNC">(</span><span class="NAME">rowidx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>376</span> </span><span class="WHIT">    					 </span><span class="PUNC">}</span><span class="WHIT">	 </span><span class="WHIT">
<span class='line'>377</span> </span><span class="COMM">//        			}else{</span><span class="WHIT">
<span class='line'>378</span> </span><span class="COMM">//        				_this.unSelectRow(rowidx, _tr);</span><span class="WHIT">
<span class='line'>379</span> </span><span class="COMM">//        			}</span><span class="WHIT">
<span class='line'>380</span> </span><span class="WHIT">    			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>381</span> </span><span class="WHIT">    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isCheckboxAll</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>382</span> </span><span class="WHIT">        			</span><span class="NAME">_this.stateTest</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>383</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>384</span> </span><span class="WHIT">    		 </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>385</span> 
<span class='line'>386</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>387</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>388</span> </span><span class="WHIT">    </span><span class="WHIT">
<span class='line'>389</span> </span><span class="WHIT">        </span><span class="COMM">// 表格单击,双击事件</span><span class="WHIT">
<span class='line'>390</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rowClickObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>391</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rowDBLClickObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>392</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rowClickFn</span><span class="PUNC">=</span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>393</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rowDBLClickFn</span><span class="PUNC">=</span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>394</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.data</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>395</span> </span><span class="COMM">//        this.rowclick = this.el.attr("rowclick");</span><span class="WHIT">
<span class='line'>396</span> </span><span class="COMM">//        this.rowdblclick = this.el.attr("rowdblclick");</span><span class="WHIT">
<span class='line'>397</span> </span><span class="WHIT">        </span><span class="NAME">$.each</span><span class="PUNC">(</span><span class="NAME">this.params.events</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>398</span> </span><span class="WHIT">        	</span><span class="NAME">_this</span><span class="PUNC">[</span><span class="NAME">o.event.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">[</span><span class="STRN">"function"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>399</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>400</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.rowclick</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>401</span> </span><span class="WHIT">            </span><span class="NAME">rowClickObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Horn.Util.getFunObj</span><span class="PUNC">(</span><span class="NAME">this.rowclick</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>402</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$.type</span><span class="PUNC">(</span><span class="NAME">rowClickObj.fn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>403</span> </span><span class="WHIT">                </span><span class="NAME">rowClickFn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rowClickObj.fn</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>404</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>405</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>406</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.rowdblclick</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>407</span> </span><span class="WHIT">            </span><span class="NAME">rowDBLClickObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Horn.Util.getFunObj</span><span class="PUNC">(</span><span class="NAME">this.rowdblclick</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>408</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$.type</span><span class="PUNC">(</span><span class="NAME">rowDBLClickObj.fn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>409</span> </span><span class="WHIT">                </span><span class="NAME">rowDBLClickFn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rowDBLClickObj.fn</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>410</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>411</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>412</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rowClickFn</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">rowDBLClickFn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>413</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">trs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_tbody.children</span><span class="PUNC">(</span><span class="STRN">"tr"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>414</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">data.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>415</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">trs.get</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>416</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">rowClickFn</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>417</span> </span><span class="WHIT">                    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">params</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rowClickObj.params.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>418</span> </span><span class="WHIT">                    </span><span class="NAME">params.push</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>419</span> </span><span class="WHIT">                    </span><span class="NAME">tr.bind</span><span class="PUNC">(</span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="NAME">params</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>420</span> </span><span class="WHIT">                        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">e.data</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>421</span> </span><span class="WHIT">                        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">rowClickObj.fn.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>422</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>423</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>424</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">rowDBLClickFn</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>425</span> </span><span class="WHIT">                    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">params</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rowDBLClickObj.params.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>426</span> </span><span class="WHIT">                    </span><span class="NAME">params.push</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>427</span> </span><span class="WHIT">                    </span><span class="NAME">tr.bind</span><span class="PUNC">(</span><span class="STRN">'dblclick'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>428</span> </span><span class="WHIT">                        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">e.data</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>429</span> </span><span class="WHIT">                        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">rowDBLClickObj.fn.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>430</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>431</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>432</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>433</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>434</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>435</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>436</span>      * @description 设置标题
<span class='line'>437</span>      * @function
<span class='line'>438</span>      * @name Horn.Grid#&lt;b>setTitle&lt;/b>
<span class='line'>439</span>      * @param {String} title
<span class='line'>440</span>      */</span><span class="WHIT">
<span class='line'>441</span> </span><span class="WHIT">    </span><span class="NAME">setTitle</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">title</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>442</span> </span><span class="WHIT">    	</span><span class="NAME">this.titleEl.children</span><span class="PUNC">(</span><span class="STRN">'span'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="NAME">title</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>443</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>444</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>445</span>      * @ignore
<span class='line'>446</span>      * @description 当某行被引用时会触发此事件。
<span class='line'>447</span>      * @event
<span class='line'>448</span>      * @name Horn.Grid#&lt;b>onRowSelect&lt;/b>
<span class='line'>449</span>      * @param {DOMDocument} tr 当前选择的行
<span class='line'>450</span>      * @param {int} rowidx 行号
<span class='line'>451</span>      * @param {object} vals 行数据
<span class='line'>452</span>      */</span><span class="WHIT">
<span class='line'>453</span> </span><span class="WHIT">    </span><span class="NAME">onRowSelect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>454</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>455</span>      * 所有被选中值
<span class='line'>456</span>      * @ignore
<span class='line'>457</span>      * @type {Array}
<span class='line'>458</span>      */</span><span class="WHIT">
<span class='line'>459</span> </span><span class="WHIT">    </span><span class="NAME">selecteds</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>460</span> </span><span class="WHIT">    </span><span class="NAME">stateTest</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>461</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>462</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">checkAll</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>463</span> </span><span class="WHIT">		</span><span class="NAME">_this.el.find</span><span class="PUNC">(</span><span class="STRN">'input:checkbox.h_querytable_select'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="NAME">checkbox</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>464</span> </span><span class="WHIT">    		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">checkbox</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>465</span> </span><span class="WHIT">    			</span><span class="NAME">checkAll</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>466</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>467</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>468</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">checkAll</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>469</span> </span><span class="WHIT">			</span><span class="NAME">_this.el.find</span><span class="PUNC">(</span><span class="STRN">'.h_querytable_select_all'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>470</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>471</span> </span><span class="WHIT">			</span><span class="NAME">_this.el.find</span><span class="PUNC">(</span><span class="STRN">'.h_querytable_select_all'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>472</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>473</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>474</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>475</span>      * @description 选择所有行。
<span class='line'>476</span>      * @function
<span class='line'>477</span>      * @name Horn.Grid#&lt;b>selectAll&lt;/b>
<span class='line'>478</span>      */</span><span class="WHIT">
<span class='line'>479</span> </span><span class="WHIT">    </span><span class="NAME">selectAll</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>480</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>481</span> </span><span class="WHIT">    	</span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'input:checkbox.h_querytable_select'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="NAME">checkbox</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>482</span> </span><span class="WHIT">    		</span><span class="NAME">checkbox.checked</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>483</span> </span><span class="WHIT">    		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">_this.rowSelect</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">  </span><span class="COMM">//6599</span><span class="WHIT">
<span class='line'>484</span> </span><span class="WHIT">    			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">checkbox</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trigger</span><span class="PUNC">(</span><span class="STRN">'change'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>485</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>486</span> </span><span class="WHIT">    			</span><span class="NAME">_this.selectRow</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>487</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>488</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>489</span> </span><span class="WHIT">    	</span><span class="COMM">//STORY #10837 【TS:201501280088-JRESPlus-财富管理事业部-陈凯-对一个grid先全选，然后去掉最后一个勾，然后再想选最后一个】</span><span class="WHIT">
<span class='line'>490</span> </span><span class="WHIT">    	</span><span class="NAME">_this.lastSelect</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>491</span> </span><span class="WHIT">    			</span><span class="NAME">rowidx</span><span class="PUNC">:</span><span class="STRN">'all'</span><span class="WHIT">
<span class='line'>492</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>493</span> </span><span class="WHIT">    	</span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'.h_querytable_select_all'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>494</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>495</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>496</span>      * @description 清除所有选择行。
<span class='line'>497</span>      * @function
<span class='line'>498</span>      * @name Horn.Grid#&lt;b>unSelectAll&lt;/b>
<span class='line'>499</span>      */</span><span class="WHIT">
<span class='line'>500</span> </span><span class="WHIT">    </span><span class="NAME">unSelectAll</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>501</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>502</span> </span><span class="WHIT">    	</span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'input:checkbox.h_querytable_select'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="NAME">checkbox</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>503</span> </span><span class="WHIT">    		</span><span class="NAME">checkbox.checked</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>504</span> </span><span class="WHIT">    		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">_this.rowSelect</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">  </span><span class="COMM">//6599</span><span class="WHIT">
<span class='line'>505</span> </span><span class="WHIT">    			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">checkbox</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trigger</span><span class="PUNC">(</span><span class="STRN">'change'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>506</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>507</span> </span><span class="WHIT">    			</span><span class="NAME">_this.unSelectRow</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>508</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>509</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>510</span> </span><span class="WHIT">    	</span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'.h_querytable_select_all'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>511</span> </span><span class="WHIT">    	</span><span class="COMM">//BUG #6613 【grid】多选模式下，先调用selectAll，然后调用unSelectAll之后，需要点击两下才能完成对行的选中</span><span class="WHIT">
<span class='line'>512</span> </span><span class="WHIT">    	</span><span class="COMM">//this.el.find('input:checkbox.h_querytable_select').attr("checked", false);</span><span class="WHIT">
<span class='line'>513</span> </span><span class="WHIT">    	</span><span class="COMM">//this.el.find('input:checkbox.h_querytable_select').parent().parent().removeClass("h_table-over");</span><span class="WHIT">
<span class='line'>514</span> </span><span class="WHIT">    	</span><span class="COMM">//this.initEvents();     //初始化事件</span><span class="WHIT">
<span class='line'>515</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>516</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>517</span>      * @description 单选时最后选择的项目
<span class='line'>518</span>      * @field
<span class='line'>519</span>      * @name Horn.Grid#lastSelect
<span class='line'>520</span>      * @default null
<span class='line'>521</span>      * @ignore
<span class='line'>522</span>      */</span><span class="WHIT">
<span class='line'>523</span> </span><span class="WHIT">     </span><span class="NAME">lastSelect</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>524</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>525</span>      * @description 是否多选
<span class='line'>526</span>      * @field
<span class='line'>527</span>      * @name Horn.Grid#mutiSelect
<span class='line'>528</span>      * @default false
<span class='line'>529</span>      * @ignore
<span class='line'>530</span>      */</span><span class="WHIT">
<span class='line'>531</span> </span><span class="WHIT">    </span><span class="NAME">mutiSelect</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>532</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>533</span>      * @description 选择某行
<span class='line'>534</span>      * @function
<span class='line'>535</span>      * @name Horn.Grid#selectRow
<span class='line'>536</span>      * @param {int} rowidx
<span class='line'>537</span>      * @param {JQuery} tr
<span class='line'>538</span>      * @ignore
<span class='line'>539</span>      */</span><span class="WHIT">
<span class='line'>540</span> </span><span class="WHIT">    </span><span class="NAME">selectRow</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">rowidx</span><span class="PUNC">,</span><span class="NAME">_tr</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>541</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_table</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>542</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_tr</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>543</span> </span><span class="WHIT">    	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>544</span> </span><span class="WHIT">    		</span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'tr'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">has</span><span class="PUNC">(</span><span class="STRN">'td'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">get</span><span class="PUNC">(</span><span class="NAME">rowidx</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>545</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>546</span> </span><span class="WHIT">    	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tr.size</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>547</span> </span><span class="WHIT">    		</span><span class="NAME">Horn.debug</span><span class="PUNC">(</span><span class="STRN">"Grid["</span><span class="PUNC">+</span><span class="NAME">this.name</span><span class="PUNC">+</span><span class="STRN">"]"</span><span class="PUNC">,</span><span class="STRN">"选择的行"</span><span class="PUNC">+</span><span class="NAME">rowidx</span><span class="PUNC">+</span><span class="STRN">"不存在"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>548</span> </span><span class="WHIT">    		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>549</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>550</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">vals</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>551</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">displays</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>552</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ths</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ths</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>553</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tr.find</span><span class="PUNC">(</span><span class="STRN">'td'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>554</span> </span><span class="WHIT">		</span><span class="NAME">ths.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">thidx</span><span class="PUNC">,</span><span class="NAME">_th</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>555</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tds.get</span><span class="PUNC">(</span><span class="NAME">thidx</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>556</span> </span><span class="WHIT">				</span><span class="NAME">th</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">_th</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>557</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">'name'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>558</span> </span><span class="WHIT">				</span><span class="NAME">vals</span><span class="PUNC">[</span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">'name'</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">'dictName'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">td</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">'key'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">td</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>559</span> </span><span class="WHIT">				</span><span class="NAME">displays</span><span class="PUNC">[</span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">'name'</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">td</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>560</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>561</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>562</span> </span><span class="WHIT">		</span><span class="NAME">_table.onRowSelect.call</span><span class="PUNC">(</span><span class="NAME">tr</span><span class="PUNC">,</span><span class="NAME">tr</span><span class="PUNC">,</span><span class="NAME">rowidx</span><span class="PUNC">,</span><span class="NAME">vals</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>563</span> </span><span class="WHIT">		</span><span class="NAME">this.selecteds</span><span class="PUNC">[</span><span class="NAME">rowidx</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">val</span><span class="PUNC">:</span><span class="NAME">vals</span><span class="PUNC">,</span><span class="NAME">displays</span><span class="PUNC">:</span><span class="NAME">displays</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>564</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_table.mutiSelect</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>565</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">last</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_table.lastSelect</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>566</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">last</span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">last.rowidx</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">rowidx</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>567</span> </span><span class="WHIT">				</span><span class="COMM">//BUG #6609 【grid】selectModel设置为single 造成页面报js错误并且单选变复选</span><span class="WHIT">
<span class='line'>568</span> </span><span class="WHIT">		    	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.mutiSelect</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="COMM">//多选</span><span class="WHIT">
<span class='line'>569</span> </span><span class="WHIT">		    		</span><span class="NAME">last.tr.find</span><span class="PUNC">(</span><span class="STRN">"input:checkbox.h_querytable_select"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>570</span> </span><span class="WHIT">		    	</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="COMM">//单选</span><span class="WHIT">
<span class='line'>571</span> </span><span class="WHIT">		    		</span><span class="NAME">last.tr.find</span><span class="PUNC">(</span><span class="STRN">"input:radio.h_querytable_select"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="WHIT">
<span class='line'>572</span> </span><span class="WHIT">		    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>573</span> </span><span class="WHIT">				</span><span class="NAME">_table.unSelectRow</span><span class="PUNC">(</span><span class="NAME">last.rowidx</span><span class="PUNC">,</span><span class="NAME">last.tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>574</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>575</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>576</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>577</span> </span><span class="WHIT">		</span><span class="NAME">_table.lastSelect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>578</span> </span><span class="WHIT">				</span><span class="NAME">rowidx</span><span class="PUNC">:</span><span class="NAME">rowidx</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>579</span> </span><span class="WHIT">				</span><span class="NAME">tr</span><span class="PUNC">:</span><span class="NAME">tr</span><span class="WHIT">
<span class='line'>580</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>581</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>582</span> </span><span class="WHIT">		</span><span class="COMM">//BUG #6609 【grid】selectModel设置为single 造成页面报js错误并且单选变复选</span><span class="WHIT">
<span class='line'>583</span> </span><span class="WHIT">    	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.mutiSelect</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="COMM">//多选</span><span class="WHIT">
<span class='line'>584</span> </span><span class="WHIT">    		</span><span class="NAME">tr.find</span><span class="PUNC">(</span><span class="STRN">"input:checkbox.h_querytable_select"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="COMM">//选中checkbox</span><span class="WHIT">
<span class='line'>585</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="COMM">//单选</span><span class="WHIT">
<span class='line'>586</span> </span><span class="WHIT">    		</span><span class="NAME">tr.find</span><span class="PUNC">(</span><span class="STRN">"input:radio.h_querytable_select"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="COMM">//选中radio</span><span class="WHIT">
<span class='line'>587</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>588</span> </span><span class="WHIT">		</span><span class="NAME">tr.addClass</span><span class="PUNC">(</span><span class="STRN">"h_table-over"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="COMM">//选中行的样式</span><span class="WHIT">
<span class='line'>589</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>590</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>591</span>      * @description 取消某行的选择
<span class='line'>592</span>      * TODO 这里尚有些不成熟的地方，需要取消选择项的勾。
<span class='line'>593</span>      * @function
<span class='line'>594</span>      * @name Horn.Grid#unSelectRow
<span class='line'>595</span>      * @param {DOMDocument} rowidx
<span class='line'>596</span>      * @param {DOMDocument} tr
<span class='line'>597</span>      * @ignore
<span class='line'>598</span>      */</span><span class="WHIT">
<span class='line'>599</span> </span><span class="WHIT">    </span><span class="NAME">unSelectRow</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">rowidx</span><span class="PUNC">,</span><span class="NAME">_tr</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>600</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_tr</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>601</span> </span><span class="WHIT">    	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>602</span> </span><span class="WHIT">    		</span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'tr'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">has</span><span class="PUNC">(</span><span class="STRN">'td'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">get</span><span class="PUNC">(</span><span class="NAME">rowidx</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">    </span><span class="COMM">//BUG #6720</span><span class="WHIT">
<span class='line'>603</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>604</span> </span><span class="WHIT">    	</span><span class="WHIT">
<span class='line'>605</span> </span><span class="WHIT">    	</span><span class="NAME">this.selecteds</span><span class="PUNC">[</span><span class="NAME">rowidx</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>606</span> </span><span class="WHIT">    	</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.selecteds</span><span class="PUNC">[</span><span class="NAME">rowidx</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>607</span> </span><span class="WHIT">    	</span><span class="NAME">tr.removeClass</span><span class="PUNC">(</span><span class="STRN">"h_table-over"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="COMM">//取消选中行的样式</span><span class="WHIT">
<span class='line'>608</span> </span><span class="WHIT">    	</span><span class="COMM">//BUG #6609 【grid】selectModel设置为single 造成页面报js错误并且单选变复选</span><span class="WHIT">
<span class='line'>609</span> </span><span class="WHIT">    	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.mutiSelect</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="COMM">//多选</span><span class="WHIT">
<span class='line'>610</span> </span><span class="WHIT">    		</span><span class="NAME">tr.find</span><span class="PUNC">(</span><span class="STRN">"input:checkbox.h_querytable_select"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">    </span><span class="COMM">//取消选中checkbox</span><span class="WHIT">
<span class='line'>611</span> </span><span class="WHIT">    		</span><span class="COMM">//BUG #6943 grid：复选，去掉某行的勾，但是列头的全选勾不会去除</span><span class="WHIT">
<span class='line'>612</span> </span><span class="WHIT">    		</span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'.h_querytable_select_all'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>613</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="COMM">//单选</span><span class="WHIT">
<span class='line'>614</span> </span><span class="WHIT">    		</span><span class="NAME">tr.find</span><span class="PUNC">(</span><span class="STRN">"input:radio.h_querytable_select"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">"checked"</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//取消选中radio</span><span class="WHIT">
<span class='line'>615</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>616</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>617</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>618</span>      * @description 获取所有的选择项
<span class='line'>619</span>      * @function
<span class='line'>620</span>      * @name Horn.Grid#&lt;b>getSelecteds&lt;/b>
<span class='line'>621</span>      * @param {mix} format(可选值有true,1,或者不传参数)&lt;br/>
<span class='line'>622</span>      *         true    ：返回整行完整数  如：[{"branchNo":"001","Date":"20140320"}{"branchNo":"001","Date":"20140320"}]&lt;br/>
<span class='line'>623</span>      *         1       : 返回列数据的字段值，如果是字典列,返回字典的value值&lt;br/>
<span class='line'>624</span>      *         无参数  : 返回列数据的字段值 如果是字典列,返回label值
<span class='line'>625</span>      * @return {Array} 返回选中的行数据
<span class='line'>626</span>      */</span><span class="WHIT">
<span class='line'>627</span> </span><span class="WHIT">    </span><span class="NAME">getSelecteds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">format</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>628</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">selecteds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>629</span> </span><span class="WHIT">    	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.selecteds</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>630</span> </span><span class="WHIT">    		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">valObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.selecteds</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>631</span> </span><span class="WHIT">    		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">valObj</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>632</span> </span><span class="WHIT">    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tmpv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">valObj.val</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>633</span> </span><span class="WHIT">    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">format</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>634</span> </span><span class="WHIT">    				</span><span class="NAME">tmpv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.data</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>635</span> </span><span class="WHIT">    			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">format</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>636</span> </span><span class="WHIT">    				</span><span class="NAME">tmpv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">valObj.displays</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>637</span> </span><span class="WHIT">    			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>638</span> </span><span class="WHIT">    			</span><span class="NAME">selecteds.push</span><span class="PUNC">(</span><span class="NAME">tmpv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>639</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>640</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>641</span> </span><span class="WHIT">    	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">selecteds</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>642</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>643</span> </span><span class="WHIT">     </span><span class="COMM">/**
<span class='line'>644</span>      * @description 设置当前行为传入的行
<span class='line'>645</span>      * @function
<span class='line'>646</span>      * @return {void}
<span class='line'>647</span>      * @name Horn.Grid#changeCurrent
<span class='line'>648</span>      * @param {DOMDocument} tr 传入的行
<span class='line'>649</span>      * @ignore
<span class='line'>650</span>      */</span><span class="WHIT">
<span class='line'>651</span> </span><span class="WHIT">    </span><span class="NAME">changeCurrent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>652</span> </span><span class="WHIT">    	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tr</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>653</span> </span><span class="WHIT">    		</span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.children</span><span class="PUNC">(</span><span class="STRN">'tbody'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">children</span><span class="PUNC">(</span><span class="STRN">'tr'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">tr</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>654</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>655</span> </span><span class="WHIT">    	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.curtr</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>656</span> </span><span class="WHIT">    		</span><span class="NAME">this.curtr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">'tr.hc_formtable-cur'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>657</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>658</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rowidx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.children</span><span class="PUNC">(</span><span class="STRN">'table'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">children</span><span class="PUNC">(</span><span class="STRN">'tbody'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">children</span><span class="PUNC">(</span><span class="STRN">'tr'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">index</span><span class="PUNC">(</span><span class="NAME">this.curtr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>659</span> </span><span class="WHIT">    	</span><span class="NAME">this.curtr.removeClass</span><span class="PUNC">(</span><span class="STRN">'hc_formtable-cur'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>660</span> </span><span class="WHIT">    	</span><span class="NAME">tr.addClass</span><span class="PUNC">(</span><span class="STRN">'hc_formtable-cur'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>661</span> </span><span class="WHIT">    	</span><span class="NAME">this.curtr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>662</span> </span><span class="WHIT">    	</span><span class="NAME">this.curData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.data</span><span class="PUNC">[</span><span class="NAME">rowidx</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>663</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>664</span> </span><span class="WHIT">     </span><span class="COMM">/**
<span class='line'>665</span>      * @description 获取当前行的数据
<span class='line'>666</span>      * @function
<span class='line'>667</span>      * @name Horn.Grid#getCurrentData
<span class='line'>668</span>      * @return {object}
<span class='line'>669</span>      * @ignore
<span class='line'>670</span>      */</span><span class="WHIT">
<span class='line'>671</span> </span><span class="WHIT">    </span><span class="NAME">getCurrentData</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>672</span> </span><span class="WHIT">    	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.curData</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>673</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>674</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>675</span>      * 隐藏列
<span class='line'>676</span>      * @ignore
<span class='line'>677</span>      */</span><span class="WHIT">
<span class='line'>678</span> </span><span class="WHIT">    </span><span class="NAME">hiddenColumns</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>679</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">trs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.children</span><span class="PUNC">(</span><span class="STRN">'table'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">children</span><span class="PUNC">(</span><span class="STRN">'tbody'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">children</span><span class="PUNC">(</span><span class="STRN">'tr'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>680</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ths</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ths</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>681</span> </span><span class="WHIT">    	</span><span class="WHIT">
<span class='line'>682</span> </span><span class="WHIT">    	</span><span class="NAME">ths.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">thidx</span><span class="PUNC">,</span><span class="NAME">thdom</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>683</span> </span><span class="WHIT">    		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">th</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">thdom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>684</span> </span><span class="WHIT">    		</span><span class="COMM">//隐藏列</span><span class="WHIT">
<span class='line'>685</span> </span><span class="WHIT">    		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">hidden</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">thdom.attributes</span><span class="PUNC">[</span><span class="STRN">"hidden"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>686</span> </span><span class="WHIT">    		</span><span class="WHIT">
<span class='line'>687</span> </span><span class="WHIT">    		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">hidden</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">hidden</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">hidden.value</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="STRN">"true"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>688</span> </span><span class="WHIT">    			</span><span class="NAME">th.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>689</span> </span><span class="WHIT">    			</span><span class="COMM">//trs each</span><span class="WHIT">
<span class='line'>690</span> </span><span class="WHIT">    	    	</span><span class="NAME">trs.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tridx</span><span class="PUNC">,</span><span class="NAME">trdom</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>691</span> </span><span class="WHIT">    	    		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">trdom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>692</span> </span><span class="WHIT">    	    		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tr.find</span><span class="PUNC">(</span><span class="STRN">'td'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>693</span> </span><span class="WHIT">    	    		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tdidx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">tdidx</span><span class="PUNC">&lt;</span><span class="NAME">tds.length</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">tdidx</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>694</span> </span><span class="WHIT">    	    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">tds</span><span class="PUNC">[</span><span class="NAME">tdidx</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>695</span> </span><span class="WHIT">    	    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">thidx</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">tdidx</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>696</span> </span><span class="WHIT">    	    				</span><span class="NAME">td.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>697</span> </span><span class="WHIT">    	    				</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>698</span> </span><span class="WHIT">    	    			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>699</span> </span><span class="WHIT">    	    		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>700</span> </span><span class="WHIT">    	    	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>701</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>702</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>703</span> </span><span class="WHIT">    	</span><span class="WHIT">
<span class='line'>704</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>705</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>706</span>      * @param dataType   格式化类型(DATE,AMOUNT)
<span class='line'>707</span>      * @param format     格式
<span class='line'>708</span>      * @param td         td对象
<span class='line'>709</span>      * 表格列格式化
<span class='line'>710</span>      * 列需要支持常规类型的格式化配置（日期、金额）
<span class='line'>711</span>      * @private
<span class='line'>712</span>      * @ignore
<span class='line'>713</span>      */</span><span class="WHIT">
<span class='line'>714</span> </span><span class="WHIT">    </span><span class="NAME">formatColumn</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">dataType</span><span class="PUNC">,</span><span class="NAME">format</span><span class="PUNC">,</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>715</span> </span><span class="WHIT">    	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Horn.Util.Format.all</span><span class="PUNC">(</span><span class="NAME">dataType</span><span class="PUNC">,</span><span class="NAME">format</span><span class="PUNC">,</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>716</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>717</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>718</span>      * 当table的布局为fixed时候，需要为th设置默认宽度
<span class='line'>719</span>      * @ignore
<span class='line'>720</span>      */</span><span class="WHIT">
<span class='line'>721</span> </span><span class="WHIT">    </span><span class="NAME">resetTHWidth</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>722</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ths</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ths</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>723</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">size</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ths.size</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>724</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_table</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.children</span><span class="PUNC">(</span><span class="STRN">'table'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>725</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_table.width</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>726</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">temp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>727</span> </span><span class="WHIT">    	</span><span class="NAME">ths.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="NAME">thdom</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>728</span> </span><span class="WHIT">    		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">th</span><span class="WHIT">  </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">thdom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>729</span> </span><span class="WHIT">    		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">th.hasClass</span><span class="PUNC">(</span><span class="STRN">'h_numbercolumn'</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">th.hasClass</span><span class="PUNC">(</span><span class="STRN">'h_querytable_checkboxcolumn'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">   </span><span class="COMM">//去掉数字、check列</span><span class="WHIT">
<span class='line'>730</span> </span><span class="WHIT">    			</span><span class="NAME">th.addClass</span><span class="PUNC">(</span><span class="STRN">"h_table_th_extend"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>731</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">thdom.attributes</span><span class="PUNC">[</span><span class="STRN">"hidden"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">   </span><span class="COMM">//去掉隐藏列</span><span class="WHIT">
<span class='line'>732</span> </span><span class="WHIT">    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">hidden</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">thdom.attributes</span><span class="PUNC">[</span><span class="STRN">"hidden"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="WHIT">
<span class='line'>733</span> </span><span class="WHIT">        		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">hidden</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">hidden</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">hidden.value</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="STRN">"true"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>734</span> </span><span class="WHIT">        			</span><span class="NAME">size</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>735</span> </span><span class="WHIT">        		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>736</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="COMM">//去掉已设置width属性的列</span><span class="WHIT">
<span class='line'>737</span> </span><span class="WHIT">    			</span><span class="NAME">size</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>738</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>739</span> </span><span class="WHIT">    			</span><span class="NAME">temp.push</span><span class="PUNC">(</span><span class="NAME">th</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>740</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="WHIT">     </span><span class="WHIT">
<span class='line'>741</span> </span><span class="WHIT">    		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>742</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>743</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">percent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">/</span><span class="NAME">size</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>744</span> </span><span class="WHIT">    	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">temp.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>745</span> </span><span class="WHIT">    		</span><span class="NAME">temp</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">css</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">percent.toFixed</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>746</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>747</span> </span><span class="WHIT">    	</span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>748</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>749</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>750</span>      * 翻译字典 
<span class='line'>751</span>      * @ignore
<span class='line'>752</span>      */</span><span class="WHIT">
<span class='line'>753</span> </span><span class="WHIT">    </span><span class="NAME">dictTrans</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>754</span> </span><span class="WHIT">    	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_table</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>755</span> </span><span class="WHIT">    		</span><span class="NAME">ths</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ths</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>756</span> </span><span class="WHIT">    		</span><span class="NAME">trs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.el.find</span><span class="PUNC">(</span><span class="STRN">"tr"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>757</span> </span><span class="WHIT">    	</span><span class="WHIT">
<span class='line'>758</span> </span><span class="WHIT">    	</span><span class="NAME">trs.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="NAME">trdom</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>759</span> </span><span class="WHIT">    		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">trdom</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>760</span> </span><span class="WHIT">    		</span><span class="NAME">checkbox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_table.mutiSelect</span><span class="PUNC">?</span><span class="NAME">tr.find</span><span class="PUNC">(</span><span class="STRN">"input:checkbox"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">tr.find</span><span class="PUNC">(</span><span class="STRN">"input:radio"</span><span class="PUNC">)</span><span class="COMM">//BUG #6574</span><span class="WHIT">
<span class='line'>761</span> </span><span class="WHIT">    		</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>762</span> </span><span class="WHIT">    		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">checkbox.hasClass</span><span class="PUNC">(</span><span class="STRN">'h_querytable_select'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>763</span> </span><span class="WHIT">    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">_table.rowSelect</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">           </span><span class="COMM">//BUG #6599</span><span class="WHIT">
<span class='line'>764</span> </span><span class="WHIT">	    			</span><span class="NAME">checkbox.change</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>765</span> </span><span class="WHIT">		    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.checked</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>766</span> </span><span class="WHIT">		    				</span><span class="NAME">_table.selectRow</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>767</span> </span><span class="WHIT">		    			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>768</span> </span><span class="WHIT">		    				</span><span class="NAME">_table.unSelectRow</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>769</span> </span><span class="WHIT">		    			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>770</span> </span><span class="WHIT">		    		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>771</span> </span><span class="WHIT">    			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>772</span> </span><span class="WHIT">    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">checkbox.attr</span><span class="PUNC">(</span><span class="STRN">'checked'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>773</span> </span><span class="WHIT">    				</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>774</span> </span><span class="WHIT">    					</span><span class="NAME">_table.selectRow</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>775</span> </span><span class="WHIT">    				</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>776</span> </span><span class="WHIT">    			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>777</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>778</span> </span><span class="WHIT">    		</span><span class="NAME">tr.find</span><span class="PUNC">(</span><span class="STRN">'td'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tdidx</span><span class="PUNC">,</span><span class="NAME">tddom</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>779</span> </span><span class="WHIT">    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">tddom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>780</span> </span><span class="WHIT">    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">th</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">ths.get</span><span class="PUNC">(</span><span class="NAME">tdidx</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>781</span> </span><span class="WHIT">	    		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dictName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">"dictname"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>782</span> </span><span class="WHIT">	    			</span><span class="NAME">mutidict</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">"multiple"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>783</span> </span><span class="WHIT">	    			</span><span class="NAME">staticDict</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.data</span><span class="PUNC">(</span><span class="STRN">'staticDict'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>784</span> </span><span class="WHIT">	    			</span><span class="NAME">renderer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">'renderer'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>785</span> </span><span class="WHIT">	    			</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.data</span><span class="PUNC">(</span><span class="STRN">'buttons'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>786</span> </span><span class="WHIT">	    			</span><span class="NAME">showwhenover</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">'showwhenover'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>787</span> </span><span class="WHIT">	    			</span><span class="NAME">dataType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">'dataType'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>788</span> </span><span class="WHIT">	    			</span><span class="NAME">format</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">th.attr</span><span class="PUNC">(</span><span class="STRN">'format'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>789</span> </span><span class="WHIT">	    			</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>790</span> </span><span class="WHIT">	    		</span><span class="WHIT">
<span class='line'>791</span> </span><span class="WHIT">	    		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">staticDict</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>792</span> </span><span class="WHIT">	    			</span><span class="NAME">td.attr</span><span class="PUNC">(</span><span class="STRN">'key'</span><span class="PUNC">,</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>793</span> </span><span class="WHIT">	    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>794</span> </span><span class="WHIT">	    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">mutidict</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>795</span> </span><span class="WHIT">    					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">textArr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>796</span> </span><span class="WHIT">    					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">text.trim</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>797</span> </span><span class="WHIT">    						</span><span class="NAME">textArr.push</span><span class="PUNC">(</span><span class="NAME">staticDict</span><span class="PUNC">[</span><span class="NAME">item</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>798</span> </span><span class="WHIT">    					</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>799</span> </span><span class="WHIT">    					</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="NAME">textArr.join</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>800</span> </span><span class="WHIT">    					</span><span class="NAME">td.attr</span><span class="PUNC">(</span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="NAME">textArr.join</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>801</span> </span><span class="WHIT">    				</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>802</span> </span><span class="WHIT">    					</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">staticDict</span><span class="PUNC">[</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trim</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>803</span> </span><span class="WHIT">    					</span><span class="NAME">td.attr</span><span class="PUNC">(</span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="NAME">staticDict</span><span class="PUNC">[</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trim</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>804</span> </span><span class="WHIT">    				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>805</span> </span><span class="WHIT">	    		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">dictName</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>806</span> </span><span class="WHIT">	    			</span><span class="NAME">td.attr</span><span class="PUNC">(</span><span class="STRN">'key'</span><span class="PUNC">,</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>807</span> </span><span class="WHIT">	    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>808</span> </span><span class="WHIT">	    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dict</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Horn.getDict</span><span class="PUNC">(</span><span class="NAME">dictName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>809</span> </span><span class="WHIT">	    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">dict</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>810</span> </span><span class="WHIT">	    				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">mutidict</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>811</span> </span><span class="WHIT">	    					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">textArr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>812</span> </span><span class="WHIT">	    					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">text.split</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>813</span> </span><span class="WHIT">	    						</span><span class="NAME">textArr.push</span><span class="PUNC">(</span><span class="NAME">dict</span><span class="PUNC">[</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>814</span> </span><span class="WHIT">	    					</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>815</span> </span><span class="WHIT">	    					</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="NAME">textArr.join</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>816</span> </span><span class="WHIT">	    					</span><span class="NAME">td.attr</span><span class="PUNC">(</span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="NAME">textArr.join</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>817</span> </span><span class="WHIT">	    				</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>818</span> </span><span class="WHIT">	    					</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="NAME">dict</span><span class="PUNC">[</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>819</span> </span><span class="WHIT">	    					</span><span class="NAME">td.attr</span><span class="PUNC">(</span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="NAME">staticDict</span><span class="PUNC">[</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trim</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>820</span> </span><span class="WHIT">	    				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>821</span> </span><span class="WHIT">	    			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>822</span> </span><span class="WHIT">	    				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">li</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'.hc_checkboxdiv[ref_target='</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">dictName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'_s]'</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">find</span><span class="PUNC">(</span><span class="STRN">"li[key="</span><span class="PUNC">+</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"]"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>823</span> </span><span class="WHIT">	    				</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="NAME">li.attr</span><span class="PUNC">(</span><span class="STRN">'title'</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>824</span> </span><span class="WHIT">	    			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>825</span> </span><span class="WHIT">	    			</span><span class="WHIT">
<span class='line'>826</span> </span><span class="WHIT">	    			</span><span class="WHIT">
<span class='line'>827</span> </span><span class="WHIT">	    		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">buttons</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>828</span> </span><span class="WHIT">	    			</span><span class="NAME">td.attr</span><span class="PUNC">(</span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>829</span> </span><span class="WHIT">	    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">btns</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>830</span> </span><span class="WHIT">	    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">span</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">"&lt;span>&lt;/span>"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>831</span> </span><span class="WHIT">	    			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">btns</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idxx</span><span class="PUNC">,</span><span class="NAME">btn</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>832</span> </span><span class="WHIT">	    				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Horn.Util.getFunObj</span><span class="PUNC">(</span><span class="NAME">btn.event</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>833</span> </span><span class="WHIT">	    				</span><span class="COMM">//如果没有这个function，则不装入这个button</span><span class="WHIT">
<span class='line'>834</span> </span><span class="WHIT">	    				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">fn.fn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>835</span> </span><span class="WHIT">	    				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">"&lt;a href='javascript:void(0)'>"</span><span class="PUNC">+</span><span class="NAME">btn.label</span><span class="PUNC">+</span><span class="STRN">"&lt;/a>"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>836</span> </span><span class="WHIT">	    					</span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>837</span> </span><span class="WHIT">	    				</span><span class="NAME">a.click</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>838</span> </span><span class="WHIT">	    					</span><span class="NAME">fn.fn.call</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>839</span> </span><span class="WHIT">	    	    				</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">text</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>840</span> </span><span class="WHIT">	    	    				</span><span class="NAME">rowdata</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">_table.data</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>841</span> </span><span class="WHIT">	    	    				</span><span class="NAME">alldata</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">_table.data</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>842</span> </span><span class="WHIT">	    	    				</span><span class="NAME">table</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">_table</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>843</span> </span><span class="WHIT">	    	    				</span><span class="NAME">rowidx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>844</span> </span><span class="WHIT">	    	    				</span><span class="NAME">tdidx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tdidx</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>845</span> </span><span class="WHIT">	    	    				</span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>846</span> </span><span class="WHIT">	    	    				</span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">td</span><span class="WHIT">
<span class='line'>847</span> </span><span class="WHIT">	    	    			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>848</span> </span><span class="WHIT">	    				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>849</span> </span><span class="WHIT">	    				</span><span class="NAME">span.append</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>850</span> </span><span class="WHIT">	    				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">idxx</span><span class="PUNC">!=</span><span class="PUNC">(</span><span class="NAME">btns.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>851</span> </span><span class="WHIT">	    					</span><span class="NAME">span.append</span><span class="PUNC">(</span><span class="STRN">' | '</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>852</span> </span><span class="WHIT">	    				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>853</span> </span><span class="WHIT">	    			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>854</span> </span><span class="WHIT">	    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">showwhenover</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>855</span> </span><span class="WHIT">	    				</span><span class="NAME">span.addClass</span><span class="PUNC">(</span><span class="STRN">'h_link-default'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>856</span> </span><span class="WHIT">	    			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>857</span> </span><span class="WHIT">	    			</span><span class="NAME">td.html</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>858</span> </span><span class="WHIT">	    			</span><span class="NAME">td.append</span><span class="PUNC">(</span><span class="NAME">span</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>859</span> </span><span class="WHIT">	    		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">dataType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>860</span> </span><span class="WHIT">	    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>861</span> </span><span class="WHIT">	    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newVal</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_table.formatColumn</span><span class="PUNC">(</span><span class="NAME">dataType</span><span class="PUNC">,</span><span class="NAME">format</span><span class="PUNC">,</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>862</span> </span><span class="WHIT">	    			</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="NAME">newVal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>863</span> </span><span class="WHIT">	    			</span><span class="NAME">td.attr</span><span class="PUNC">(</span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="NAME">newVal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>864</span> </span><span class="WHIT">	    		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>865</span> </span><span class="WHIT">	    		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">renderer</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>866</span> </span><span class="WHIT">	    			</span><span class="NAME">td.attr</span><span class="PUNC">(</span><span class="STRN">'key'</span><span class="PUNC">,</span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>867</span> </span><span class="WHIT">	    			</span><span class="NAME">td.attr</span><span class="PUNC">(</span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>868</span> </span><span class="WHIT">	    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Horn.Util.getFunObj</span><span class="PUNC">(</span><span class="NAME">renderer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>869</span> </span><span class="WHIT">	    				</span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.text</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>870</span> </span><span class="WHIT">    				</span><span class="COMM">//如果没有这个function，则不装入这个button</span><span class="WHIT">
<span class='line'>871</span> </span><span class="WHIT">    				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">fn.fn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>872</span> </span><span class="WHIT">	    			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fn.fn.call</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>873</span> </span><span class="WHIT">	    				</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">text</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>874</span> </span><span class="WHIT">	    				</span><span class="NAME">rowdata</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">_table.data</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>875</span> </span><span class="WHIT">	    				</span><span class="NAME">alldata</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">_table.data</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>876</span> </span><span class="WHIT">	    				</span><span class="NAME">table</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">_table</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>877</span> </span><span class="WHIT">	    				</span><span class="NAME">rowidx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>878</span> </span><span class="WHIT">	    				</span><span class="NAME">tdidx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tdidx</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>879</span> </span><span class="WHIT">	    				</span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>880</span> </span><span class="WHIT">	    				</span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">td</span><span class="WHIT">
<span class='line'>881</span> </span><span class="WHIT">	    			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>882</span> </span><span class="WHIT">	    			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">dom</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">$</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>883</span> </span><span class="WHIT">	    				</span><span class="NAME">td.html</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>884</span> </span><span class="WHIT">	    				</span><span class="NAME">td.append</span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>885</span> </span><span class="WHIT">	    			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>886</span> </span><span class="WHIT">	    				</span><span class="NAME">td.html</span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>887</span> </span><span class="WHIT">	    			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>888</span> </span><span class="WHIT">	    		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>889</span> </span><span class="WHIT">    		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>890</span> </span><span class="WHIT">    	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>891</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>892</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>893</span>      * @param val 被添加的一行数据
<span class='line'>894</span>      * 向表格中添加一行数据
<span class='line'>895</span>      * @ignore
<span class='line'>896</span>      */</span><span class="WHIT">
<span class='line'>897</span> </span><span class="WHIT">    </span><span class="NAME">addRowData</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>898</span> </span><span class="WHIT">    	</span><span class="WHIT">
<span class='line'>899</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>900</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>901</span> </span><span class="NAME">Horn.regUI</span><span class="PUNC">(</span><span class="STRN">"div.h_formtable"</span><span class="PUNC">,</span><span class="NAME">Horn.Grid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>902</span> </span></pre></body></html>